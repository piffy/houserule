%h1 Elenco eventi

=will_paginate

%table{:class => "table table-striped"}
  %tr
    %th{:class => @name_header}= link_to 'Nome evento', events_path(:sort => 'name'), :id => 'name_header'
    %th{:class => @system_header}= link_to 'Sistema', events_path(:sort => 'system'), :id => 'system_header'
    %th{:class => @begins_at_header}= link_to 'Data e ora', events_path(:sort => 'begins_at'), :id => 'begins_at_header'
    %th Durata
    %th Descrizione
    %th Conferma?
    %th Status
    %th Luogo
    %th Pren.
    %th
    %th
    %th

  - @events.each do |event|
    %tr
      %td= link_to event.name, event
      %td= event.system
      %td= event.begins_at.strftime('%d-%m-%y')
      %td= event.duration
      %td= event.descr_short
      %td
        -if event.begins_at==event.deadline
          No
        -else
          =event.deadline.strftime('%d-%m-%y')
      %td= event.status_to_s
      %td= event.location
      %td
        = event.reservations.count
        = " / "  + event.max_player_num.to_s unless event.max_player_num ==0
      -if !@current_user.nil? && event.already_reserved_by(@current_user)
        %td= link_to 'Sprenota', event_reservation_path(event, event.already_reserved_by(@current_user)), :class =>"btn btn-danger"
      -else
        %td= link_to 'Prenota', new_event_reservation_path(event), :class =>"btn btn-primary"
      %td= link_to 'Modifica', edit_event_path(event), :class =>"btn"

= will_paginate
%br

= link_to 'Aggiungi evento', new_event_path, :class =>"btn"
